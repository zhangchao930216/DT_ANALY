#!/bin/bash

DDLDB=$1
DB_PATH=$2
BaseDB=$3
BasePath=$4


WAREHOUSE="user/hive/warehouse/$DDLDB.db"
#sh VolumeAnalyseInitTable.sh shanxi  'datang'

hive<<EOF

CREATE DATABASE IF NOT EXISTS ${DDLDB};
USE ${DDLDB};

--业务占比表
drop table business_type_detail;
create EXTERNAL table business_type_detail(
        TTIME              string,
        city               string,
        region             string,
        app_type           int,
        app_sub_type       int,
        uldata             bigint,
        dldata             bigint,
        counts             bigint,
        timespan           bigint,
        succCnt           bigint,
        dltime           bigint,
        resptime           bigint,
        respsucccnt        bigint
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/business_type_detail';

--volte用户表
drop table if exists volte_user_data;
CREATE  TABLE IF NOT EXISTS volte_user_data(
  ttime string,
  hours int,
  imsi string, 
  volte_start int, 
  volte_end int)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',';

--高铁用户识别表
drop table if exists volte_gtuser_data;
create EXTERNAL table if not exists volte_gtuser_data(
imsi string,
cellid string,
ttime string
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster//datang2/output/xdrnew/volte_gtuser_data';

-- 小区统计表(分钟级)
drop table if exists gt_pulse_detail;
create table if not exists gt_pulse_detail(
ttime string,
hours int,
minutes int,
cellid bigint,
imsi string,
imei string,
gtuser_flag int,
volteuser_flag int,
sub_pulse_mark int)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;



--子脉冲统计表(分钟级)
drop table if exists  gt_pulse_cell_min;
create table if not exists gt_pulse_cell_min(
ttime string,
hours int,
minutes int,
cellid bigint,
sub_pulse_mark int,
sub_pulse_type int,
users bigint,
gt_users bigint,
comm_users bigint,
volte_users bigint)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

--脉冲统计小时表
drop table if exists gt_pulse_cell_base60;
create table if not exists gt_pulse_cell_base60(
     ttime string,
     hours int,
     cellid bigint,
     pulse_mark bigint,
     pulse_type bigint,
     pulse_timelen bigint,
     first_pulse_mark bigint,
     sub_users_peak bigint,
     sub_gtusers_peak bigint,
     sub_volteusers_peak bigint,
     sub_commusers_peak bigint,
     users bigint,
     gt_users bigint,
     volte_users bigint)
PARTITIONED BY ( 
  dt string,
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;


--脉冲明细小时表
drop table  if exists gt_pulse_detail_base60;
create table if not exists gt_pulse_detail_base60(
ttime string,
hours int,
cellid bigint,
imsi string,
pulse_mark bigint,
pulse_type bigint,
pulse_timelen bigint,
first_pulse_mark bigint,
gtuser_flag bigint,
volteuser_flag bigint)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

--城市高铁用户频段表
drop table gt_freq_baseday;
create table if not exists gt_freq_baseday(
     line_name  string,
     city string,
     ttime string,
     cell_feq string,
     cell_num int,
     gtusers int,
     commusers int,
     cellavguses int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;



DROP TABLE   IF EXISTS LTE_MRO_SOURCE;
create EXTERNAL table   IF NOT EXISTS LTE_MRO_SOURCE
(
       objectID       STRING ,
       VID             BIGINT  ,
       fileFormatVersion STRING ,
       startTime       STRING  ,
       endTime         STRING ,
       period          BIGINT ,
       enbID           BIGINT,
       userLabel      STRING ,
       mrName         STRING ,
       cellID          BIGINT ,
       Earfcn          BIGINT ,
       SubFrameNbr     BIGINT ,
       PRBNbr          BIGINT ,
       MmeUeS1apId     BIGINT ,
       MmeGroupId      BIGINT ,
       MmeCode         BIGINT ,
       meaTime         STRING ,
       EventType      STRING ,
       gridcenterLongitude   STRING,
       gridcenterLatitude    STRING,
       kpi1            BIGINT ,
       kpi2            BIGINT ,
       kpi3            BIGINT ,
       kpi4            BIGINT ,
       kpi5            BIGINT ,
       kpi6            BIGINT ,
       kpi7            BIGINT ,
       kpi8            BIGINT ,
       kpi9            BIGINT ,
       kpi10           BIGINT ,
       kpi11           BIGINT ,
       kpi12           BIGINT ,
       kpi13           BIGINT ,
       kpi14           BIGINT ,
       kpi15           BIGINT ,
       kpi16           BIGINT ,
       kpi17           BIGINT ,
       kpi18           BIGINT ,
       kpi19           BIGINT ,
       kpi20           BIGINT ,
       kpi21           BIGINT ,
       kpi22           BIGINT ,
       kpi23           BIGINT ,
       kpi24           BIGINT ,
       kpi25           BIGINT ,
       kpi26           BIGINT ,
       kpi27           BIGINT ,
       kpi28           BIGINT ,
       kpi29           BIGINT ,
       kpi30           BIGINT ,
       kpi31           BIGINT ,
       kpi32           BIGINT ,
       kpi33           BIGINT ,
       kpi34           BIGINT ,
       kpi35           BIGINT ,
       kpi36           BIGINT ,
       kpi37           BIGINT ,
       kpi38           BIGINT ,
       kpi39           BIGINT ,
       kpi40           BIGINT ,
       kpi41           BIGINT ,
       kpi42           BIGINT ,
       kpi43           BIGINT ,
       kpi44           BIGINT ,
       kpi45           BIGINT ,
       kpi46           BIGINT ,
       kpi47           BIGINT ,
       kpi48           BIGINT ,
       kpi49           BIGINT ,
       kpi50           BIGINT ,
       kpi51           BIGINT ,
       kpi52           BIGINT ,
       kpi53           BIGINT ,
       kpi54           BIGINT ,
       kpi55           BIGINT ,
       kpi56           BIGINT ,
       kpi57           BIGINT ,
       kpi58           BIGINT ,
       kpi59           BIGINT ,
       kpi60           BIGINT ,
       kpi61           BIGINT ,
       kpi62           BIGINT ,
       kpi63           BIGINT ,
       kpi64           BIGINT ,
       kpi65           BIGINT ,
       kpi66           BIGINT ,
       kpi67           BIGINT ,
       kpi68           BIGINT ,
       kpi69           BIGINT ,
       kpi70           BIGINT ,
       kpi71           BIGINT ,
       length          BIGINT ,
       City            STRING ,
       XDRType         BIGINT ,
       Interface       BIGINT ,
       XDRID          STRING ,
       RAT             BIGINT ,
       IMSI           STRING ,
       IMEI           STRING ,
       MSISDN         STRING ,
       MRType          BIGINT ,
       NeighborCellNumber BIGINT ,
       gsmNeighborCellNumber   BIGINT ,
       tdsNeighborCellNumber   BIGINT ,
       v_enb BIGINT,
     mrtime   BIGINT
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${DB_PATH}/LTE_MRO_SOURCE';


DROP TABLE  IF EXISTS TB_XDR_IFC_GMMWMGMIMJISC;
CREATE EXTERNAL TABLE  IF NOT EXISTS TB_XDR_IFC_GMMWMGMIMJISC (
      LENGTH                        BIGINT,
      CITY                         STRING,
      INTERFACE                     BIGINT,
      XDRID                        STRING,
      RAT                           BIGINT,
      IMSI                         STRING,
      IMEI                         STRING,
      MSISDN                       STRING,
      PROCEDURETYPE                 BIGINT,
      PROCEDURESTARTTIME           BIGINT,
      PROCEDUREENDTIME             BIGINT,
      SERVICETYPE                   BIGINT,
      PROCEDURESTATUS               BIGINT,
      CALLINGNUMBER                STRING,
      CALLEDNUMBER                 STRING,
      CALLINGPARTYURI              STRING,
      REQUESTURI                   STRING,
      USERIP                       STRING,
      CALLID                       STRING,
      ICID                         STRING,
      SOURCENEIP                   STRING,
      SOURCENEPORT                  BIGINT,
      DESTNEIP                     STRING,
      DESTNEPORT                    BIGINT,
      CALLSIDE                      BIGINT,
      SOURCEACCESSTYPE              BIGINT,
      SOURCEECI                     BIGINT,
      SOURCETAC                     BIGINT,
      SOURCEIMSI                   STRING,
      SOURCEIMEI                   STRING,
      DESTACCESSTYPE                BIGINT,
      DESTECI                       BIGINT,
      DESTTAC                       BIGINT,
      DESTIMSI                     STRING,
      DESTIMEI                     STRING,
      AUTHTYPE                      BIGINT,
      EXPIRESTIMEREQ               BIGINT,
      EXPIRESTIMERSP               BIGINT,
      CALLINGSDPIPADDR             STRING,
      CALLINGAUDIOSDPPORT           BIGINT,
      CALLINGVIDEOSDPPORT           BIGINT,
      CALLEDSDPIPADDR              STRING,
      CALLEDAUDIOSDPPORT            BIGINT,
      CALLEDVIDEOPORT               BIGINT,
      AUDIOCODEC                    BIGINT,
      VIDEOCODEC                    BIGINT,
      REDIRECTINGPARTYADDRESS      STRING,
      ORIGINALPARTYADDRESS         STRING,
      REDIRECTREASON                BIGINT,
      RESPONSECODE                  BIGINT,
      FINISHWARNINGCODE             BIGINT,
      FINISHREASONPROTOCOL          BIGINT,
      FINISHREASONCAUSE             BIGINT,
      FIRFAILTIME                  BIGINT,
      FIRSTFAILNEIP                STRING,
      ALERTINGTIME                 BIGINT,
      ANSWERTIME                   BIGINT,
      RELEASETIME                  BIGINT,
      CALLDURATION                  BIGINT,
      AUTHREQTIME                  BIGINT,
      AUTHRSPTIME                  BIGINT,
      STNSR                        STRING,
      ATCFMGMT                     STRING,
      ATUSTI                       STRING,
      CMSISDN                      STRING,
      SSI                          STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${DB_PATH}/TB_XDR_IFC_GMMWMGMIMJISC';


drop table tac_hour_http;
CREATE EXTERNAL TABLE tac_hour_http(
ttime                        string,
tac                         string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc            int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzxgsucc               int,
financialzxgreq                int,
financialzxgresptimeall        int,
financialzxgresp               int,
financialzxgdownflow           int,
financialzxgdowntime           int,
financialzxgFlow               int,
financialzxgTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/tac_hour_http';

drop table tac_day_http;
CREATE EXTERNAL TABLE tac_day_http(
ttime                        string,
tac                         string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc            int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzxgsucc               int,
financialzxgreq                int,
financialzxgresptimeall        int,
financialzxgresp               int,
financialzxgdownflow           int,
financialzxgdowntime           int,
financialzxgFlow               int,
financialzxgTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/tac_day_http';

drop table cell_hour_http;
CREATE EXTERNAL TABLE cell_hour_http(
ttime                        string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/cell_hour_http';

drop table cell_day_http;
CREATE EXTERNAL TABLE cell_day_http(
ttime                        string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/cell_day_http';


drop table sp_hour_http;
CREATE EXTERNAL TABLE sp_hour_http(
ttime                        string,
appserveripipv4        string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc             int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sp_hour_http';

drop table sp_day_http;
CREATE EXTERNAL TABLE sp_day_http(
ttime                        string,
appserveripipv4             string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc             int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sp_day_http';


drop table ue_hour_http;
CREATE EXTERNAL TABLE ue_hour_http(
ttime                        string,
imsi                        string,
msisdn                      string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/ue_hour_http';


drop table ue_day_http;
CREATE EXTERNAL TABLE ue_day_http(
ttime                        string,
imsi                        string,
msisdn                      string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoreMobileMarketsucc            int,
AppStoreMobileMarketreq             int,
AppStoreMobileMarketresptimeall     int,
AppStoreMobileMarketresp            int,
AppStoreMobileMarketdownflow        int,
AppStoreMobileMarketdowntime        int,
AppStoreMobileMarketFlow            int,
AppStoreMobileMarketTime            int,
AppStoreAppStoresucc                int,
AppStoreAppStorereq                 int,
AppStoreAppStoreresptimeall         int,
AppStoreAppStoreresp                int,
AppStoreAppStoredownflow            int,
AppStoreAppStoredowntime            int,
AppStoreAppStoreFlow                int,
AppStoreAppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzixuangusucc               int,
financialzixuangureq                int,
financialzixuanguresptimeall        int,
financialzixuanguresp               int,
financialzixuangudownflow           int,
financialzixuangudowntime           int,
financialzixuanguFlow               int,
financialzixuanguTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/ue_day_http';

drop table imsi_cell_hour_http;
CREATE EXTERNAL TABLE imsi_cell_hour_http(
ttime                        string,
imsi                        string,
msisdn                      string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc              int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzxgsucc               int,
financialzxgreq                int,
financialzxgresptimeall        int,
financialzxgresp               int,
financialzxgdownflow           int,
financialzxgdowntime           int,
financialzxgFlow               int,
financialzxgTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/imsi_cell_hour_http';

drop table imsi_cell_day_http;
CREATE EXTERNAL TABLE imsi_cell_day_http(
ttime                        string,
imsi                        string,
msisdn                      string,
cellid                      bigint,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc              int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzxgsucc               int,
financialzxgreq                int,
financialzxgresptimeall        int,
financialzxgresp               int,
financialzxgdownflow           int,
financialzxgdowntime           int,
financialzxgFlow               int,
financialzxgTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/imsi_cell_day_http';

drop table sgw_hour_http;
CREATE EXTERNAL TABLE sgw_hour_http(
ttime                        string,
sgwipaddr                   string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits             int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc            int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzxgsucc               int,
financialzxgreq                int,
financialzxgresptimeall        int,
financialzxgresp               int,
financialzxgdownflow           int,
financialzxgdowntime           int,
financialzxgFlow               int,
financialzxgTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sgw_hour_http';

drop table sgw_day_http;
CREATE EXTERNAL TABLE sgw_day_http(
ttime                        string,
sgwipaddr                   string,
browsedownloadvisits        int,
videoservicevisits          int,
instantmessagevisits        int,
appvisits                   int,
browsedownloadbusiness      int,
videoservicebusiness        int,
instantmessagebusiness      int,
appbusiness                 int,
dnsQuerySucc                int,
dnsQueryAtt                 int,
tcpSetupSucc                int,
tcpSetupReq                 int,
BearerULTCPRetransmit       int,
BearerULTCPTransmit         int,
BearerDLTCPRetransmit       int,
BearerDLTCPTransmit         int,
BearerULTCPMissequence      int,
BearerDLTCPMissequence      int,
pageresp                    int,
pagereq                     int,
pageresptimeall             int,
pageshowsucc                int,
pageshowtimeall             int,
httpdownflow                int,
httpdowntime                int,
mediasucc                   int,
mediareq                    int,
mediadownflow               double,
mediadowntime               int,
ServiceIMSucc               int,
ServiceIMReq                int,
readvisits                  int,
wbvisits                    int,
navigationvisits            int,
musicvisits                 int,
gamevisits                  int,
payvisits                   int,
Animevisits                 int,
mailvisits                  int,
p2pvisits                   int,
voipvisits                  int,
MultimediaMsgvisits         int,
financialvisits            int,
securityvisits              int,
shoppingvisits              int,
travelvisits                int,
cloudstoragevisits          int,
othervisits                 int,
readbusiness                int,
wbbusiness                  int,
navigationbusiness          int,
musicbusiness               int,
gamebusiness                int,
paybusiness                 int,
Animebusiness               int,
mailbusiness                int,
p2pbusiness                 int,
voipbusiness                int,
MultimediaMsgbusiness       int,
financialbusiness           int,
securitybusiness            int,
shoppingbusiness            int,
travelbusiness              int,
cloudstoragebusiness        int,
otherbusiness               int,
mediaRespTimeall            int,
mediaResp                   int,
ServiceIMTrans              int,
ServiceIMFlow               double,
ServiceIMTime               int,
readsucc                    int,
readreq                     int,
readresptimeall             int,
readresp                    int,
readdownflow                int,
readdowntime                int,
wbsucc                      int,
wbreq                       int,
wbresptimeall               int,
wbresp                      int,
wbdownflow                  int,
wbdowntime                  int,
navigationsucc              int,
navigationreq               int,
navigationresptimeall       int,
navigationresp              int,
navigationdownflow          int,
navigationdowntime          int,
musicsucc                   int,
musicreq                    int,
musicresptimeall            int,
musicresp                   int,
musicdownflow               int,
musicdowntime               int,
appsucc                     int,
appreq                      int,
appresptimeall              int,
appresp                     int,
appdownflow                 int,
appdowntime                 int,
gamesucc                    int,
gamereq                     int,
gameresptimeall             int,
gameresp                    int,
gamedownflow                int,
gamedowntime                int,
paysucc                     int,
payreq                      int,
payresptimeall              int,
payresp                     int,
paydownflow                 int,
paydowntime                 int,
Animesucc                   int,
Animereq                    int,
Animeresptimeall            int,
Animeresp                   int,
Animedownflow               int,
Animedowntime               int,
mailsucc                    int,
mailreq                     int,
mailresptimeall             int,
mailresp                    int,
maildownflow                int,
maildowntime                int,
P2Psucc                     int,
P2Preq                      int,
P2Presptimeall              int,
P2Presp                     int,
P2Pdownflow                 int,
P2Pdowntime                 int,
VoIPsucc                    int,
VoIPreq                     int,
VoIPresptimeall             int,
VoIPresp                    int,
VoIPdownflow                int,
VoIPdowntime                int,
MultimediaMsgsucc           int,
MultimediaMsgreq            int,
MultimediaMsgresptimeall    int,
MultimediaMsgresp           int,
MultimediaMsgdownflow       int,
MultimediaMsgdowntime       int,
financialsucc               int,
financialreq                int,
financialresptimeall        int,
financialresp               int,
financialdownflow           int,
financialdowntime           int,
securitysucc                int,
securityreq                 int,
securityresptimeall         int,
securityresp                int,
securitydownflow            int,
securitydowntime            int,
shoppingsucc                int,
shoppingreq                 int,
shoppingresptimeall         int,
shoppingresp                int,
shoppingdownflow            int,
shoppingdowntime            int,
travelsucc                  int,
travelreq                   int,
travelresptimeall           int,
travelresp                  int,
traveldownflow              int,
traveldowntime              int,
cloudstoragesucc            int,
cloudstoragereq             int,
cloudstorageresptimeall     int,
cloudstorageresp            int,
cloudstoragedownflow        int,
cloudstoragedowntime        int,
internetsucc                int,
internetreq                 int,
internetresptimeall         int,
internetresp                int,
internetdownflow            int,
internetdowntime            int,
migusucc                    int,
migureq                     int,
miguresptimeall             int,
miguresp                    int,
migudownflow                int,
migudowntime                int,
othersucc                   int,
otherreq                    int,
otherresptimeall            int,
otherresp                   int,
otherdownflow               int,
otherdowntime               int,
instantmessageTime          int,
readTime                    int,
wbTime                      int,
navigationTime              int,
videoserviceTime            int,
musicTime                   int,
appTime                     int,
gameTime                    int,
payTime                     int,
AnimeTime                   int,
mailTime                    int,
p2pTime                     int,
voipTime                    int,
MultimediaMsgTime           int,
browsedownloadTime          int,
financialTime               int,
securityTime                int,
shoppingTime                int,
travelTime                  int,
cloudstorageTime            int,
internetTime                int,
miguTime                    int,
otherTime                   int,
browsesurfresp                      int,
browsesurfreq                       int,
browsesurfresptimeall               int,
browsesurfshowsucc                  int,
browsesurfshowtimeall               int,
browsesurfdownflow                  int,
browsesurfdowntime                  int,
browsesurfFlow                      int,
browsesurfTime                      int,
browsetencentresp                   int,
browsetencentreq                    int,
browsetencentresptimeall            int,
browsetencentshowsucc               int,
browsetencentshowtimeall            int,
browsetencentdownflow               int,
browsetencentdowntime               int,
browsetencentFlow                   int,
browsetencentTime                   int,
browseqqNewsresp                    int,
browseqqNewsreq                     int,
browseqqNewsresptimeall             int,
browseqqNewsshowsucc                int,
browseqqNewsshowtimeall             int,
browseqqNewsdownflow                int,
browseqqNewsdowntime                int,
browseqqNewsFlow                    int,
browseqqNewsTime                    int,
browsetoutiaoresp                   int,
browsetoutiaoreq                    int,
browsetoutiaoresptimeall            int,
browsetoutiaoshowsucc               int,
browsetoutiaoshowtimeall            int,
browsetoutiaodownflow               int,
browsetoutiaodowntime               int,
browsetoutiaoFlow                   int,
browsetoutiaoTime                   int,
browseChromeresp                    int,
browseChromereq                     int,
browseChromeresptimeall             int,
browseChromeshowsucc                int,
browseChromeshowtimeall             int,
browseChromedownflow                int,
browseChromedowntime                int,
browseChromeFlow                    int,
browseChromeTime                    int,
otherhttpresp                       int,
otherhttpreq                        int,
otherhttpresptimeall                int,
otherhttpshowsucc                   int,
otherhttpshowtimeall                int,
otherhttpdownflow                   int,
otherhttpdowntime                   int,
otherhttpFlow                       int,
otherhttpTime                       int,
videomobileTVsucc                   int,
videomobileTVreq                    int,
videomobileTVresptimeall            int,
videomobileTVresp                   int,
videomobileTVdownflow               int,
videomobileTVdowntime               int,
videomobileTVFlow                   int,
videomobileTVTime                   int,
videomiguvideosucc                  int,
videomiguvideoreq                   int,
videomiguvideoresptimeall           int,
videomiguvideoresp                  int,
videomiguvideodownflow              int,
videomiguvideodowntime              int,
videomiguvideoFlow                  int,
videomiguvideoTime                  int,
videoiqiyisucc                      int,
videoiqiyireq                       int,
videoiqiyiresptimeall               int,
videoiqiyiresp                      int,
videoiqiyidownflow                  int,
videoiqiyidowntime                  int,
videoiqiyiFlow                      int,
videoiqiyiTime                      int,
imFechatsucc                        int,
imFechatreq                         int,
imFechatresptimeall                 int,
imFechatresp                        int,
imFechatdownflow                    int,
imFechatdowntime                    int,
PayNFCFlow                        int,
PayNFCTime                        int,
imFetionsucc                        int,
imFetionreq                         int,
imFetionresptimeall                 int,
imFetionresp                        int,
imFetiondownflow                    int,
imFetiondowntime                    int,
imFetionFlow                        int,
imFetionTime                        int,
imQQsucc                            int,
imQQreq                             int,
imQQresptimeall                     int,
imQQresp                            int,
imQQdownflow                        int,
imQQdowntime                        int,
imQQFlow                            int,
imQQTime                            int,
imwechatsucc                        int,
imwechatreq                         int,
imwechatresptimeall                 int,
imwechatresp                        int,
imwechatdownflow                    int,
imwechatdowntime                    int,
imwechatFlow                        int,
imwechatTime                        int,
readcmreadsucc                      int,
readcmreadreq                       int,
readcmreadresptimeall               int,
readcmreadresp                      int,
readcmreaddownflow                  int,
readcmreaddowntime                  int,
readcmreadFlow                      int,
readcmreadTime                      int,
readsurfsucc                        int,
readsurfreq                         int,
readsurfresptimeall                 int,
readsurfresp                        int,
readsurfdownflow                    int,
readsurfdowntime                    int,
readsurtFlow                        int,
readsurfTime                        int,
readQQReadsucc                      int,
readQQReadreq                       int,
readQQReadresptimeall               int,
readQQReadresp                      int,
readQQReaddownflow                  int,
readQQReaddowntime                  int,
readQQReadFlow                      int,
readQQReadTime                      int,
weibo139wbsucc                      int,
weibo139wbreq                       int,
weibo139wbresptimeall               int,
weibo139wbresp                      int,
weibo139wbdownflow                  int,
weibo139wbdowntime                  int,
weibo139wbFlow                      int,
weibo139wbTime                      int,
weibosinaWeibosucc                  int,
weibosinaWeiboreq                   int,
weibosinaWeiboresptimeall           int,
weibosinaWeiboresp                  int,
weibosinaWeibodownflow              int,
weibosinaWeibodowntime              int,
weibosinaWeiboFlow                  int,
weibosinaWeiboTime                  int,
navigationheMapsucc                 int,
navigationheMapreq                  int,
navigationheMapresptimeall          int,
navigationheMapresp                 int,
navigationheMapdownflow             int,
navigationheMapdowntime             int,
navigationheMapFlow                 int,
navigationheMapTime                 int,
navigationaMapsucc                  int,
navigationaMapreq                   int,
navigationaMapresptimeall           int,
navigationaMapresp                  int,
navigationaMapdownflow              int,
navigationaMapdowntime              int,
navigationaMapFlow                  int,
navigationaMapTime                  int,
musicmigumusicsucc                  int,
musicmigumusicreq                   int,
musicmigumusicresptimeall           int,
musicmigumusicresp                  int,
musicmigumusicdownflow              int,
musicmigumusicdowntime              int,
musicmigumusicFlow                  int,
musicmigumusicTime                  int,
musicqqmusicsucc                    int,
musicqqmusicreq                     int,
musicqqmusicresptimeall             int,
musicqqmusicresp                    int,
musicqqmusicdownflow                int,
musicqqmusicdowntime                int,
musicqqmusicFlow                    int,
musicqqmusicTime                    int,
AppStoremmsucc            int,
AppStoremmreq             int,
AppStoremmresptimeall     int,
AppStoremmresp            int,
AppStoremmdownflow        int,
AppStoremmdowntime        int,
AppStoremmFlow            int,
AppStoremmTime            int,
AppStoresucc                int,
AppStorereq                 int,
AppStoreresptimeall         int,
AppStoreresp                int,
AppStoredownflow            int,
AppStoredowntime            int,
AppStoreFlow                int,
AppStoreTime                int,
GamemiguGamesucc                    int,
GamemiguGamereq                     int,
GamemiguGameresptimeall             int,
GamemiguGameresp                    int,
GamemiguGamedownflow                int,
GamemiguGamedowntime                int,
GamemiguGameFlow                    int,
GamemiguGameTime                    int,
Game4399Gamesucc                    int,
Game4399Gamereq                     int,
Game4399Gameresptimeall             int,
Game4399Gameresp                    int,
Game4399Gamedownflow                int,
Game4399Gamedowntime                int,
Game4399GameFlow                    int,
Game4399GameTime                    int,
PayNFCSIMsucc                       int,
PayNFCSIMreq                        int,
PayNFCSIMresptimeall                int,
PayNFCSIMresp                       int,
PayNFCSIMdownflow                   int,
PayNFCSIMdowntime                   int,
PayNFCSIMFlow                       int,
PayNFCSIMTime                       int,
PaymobilePaysucc                    int,
PaymobilePayreq                     int,
PaymobilePayresptimeall             int,
PaymobilePayresp                    int,
PaymobilePaydownflow                int,
PaymobilePaydowntime                int,
PaymobilePayFlow                    int,
PaymobilePayTime                    int,
PayAliPaysucc                          int,
PayAliPayreq                           int,
PayAliPayresptimeall                   int,
PayAliPayresp                          int,
PayAliPaydownflow                      int,
PayAliPaydowntime                      int,
PayAliPayFlow                          int,
PayAliPayTime                          int,
Animemigudmsucc                     int,
Animemigudmreq                      int,
Animemigudmresptimeall              int,
Animemigudmresp                     int,
Animemigudmdownflow                 int,
Animemigudmdowntime                 int,
AnimemigudmFlow                     int,
AnimemigudmTime                     int,
AnimeqqComicsucc                    int,
AnimeqqComicreq                     int,
AnimeqqComicresptimeall             int,
AnimeqqComicresp                    int,
AnimeqqComicdownflow                int,
AnimeqqComicdowntime                int,
AnimeqqComicFlow                    int,
AnimeqqComicTime                    int,
mail139mailsucc                     int,
mail139mailreq                      int,
mail139mailresptimeall              int,
mail139mailresp                     int,
mail139maildownflow                 int,
mail139maildowntime                 int,
mail139mailFlow                     int,
mail139mailTime                     int,
MailneteaseMailsucc                 int,
MailneteaseMailreq                  int,
MailneteaseMailresptimeall          int,
MailneteaseMailresp                 int,
MailneteaseMaildownflow             int,
MailneteaseMaildowntime             int,
MailneteaseMailFlow                 int,
MailneteaseMailTime                 int,
financialsjsjsucc                   int,
financialsjsjreq                    int,
financialsjsjresptimeall            int,
financialsjsjresp                   int,
financialsjsjdownflow               int,
financialsjsjdowntime               int,
financialsjsjFlow                   int,
financialsjsjTime                   int,
financialsjzqsucc                   int,
financialsjzqreq                    int,
financialsjzqresptimeall            int,
financialsjzqresp                   int,
financialsjzqdownflow               int,
financialsjzqdowntime               int,
financialsjzqFlow                   int,
financialsjzqTime                   int,
financialzxgsucc               int,
financialzxgreq                int,
financialzxgresptimeall        int,
financialzxgresp               int,
financialzxgdownflow           int,
financialzxgdowntime           int,
financialzxgFlow               int,
financialzxgTime               int,
Othergdqqtsucc                      int,
Othergdqqtreq                       int,
Othergdqqtresptimeall               int,
Othergdqqtresp                      int,
Othergdqqtdownflow                  int,
Othergdqqtdowntime                  int,
OthergdqqtFlow                      int,
OthergdqqtTime                      int,
Otherydzssucc                       int,
Otherydzsreq                        int,
Otherydzsresptimeall                int,
Otherydzsresp                       int,
Otherydzsdownflow                   int,
Otherydzsdowntime                   int,
OtherydzsFlow                       int,
OtherydzsTime                       int,
Othernxbstsucc                      int,
Othernxbstreq                       int,
Othernxbstresptimeall               int,
Othernxbstresp                      int,
Othernxbstdownflow                  int,
Othernxbstdowntime                  int,
OthernxbstFlow                      int,
OthernxbstTime                      int,
Othernxtsucc                        int,
Othernxtreq                         int,
Othernxtresptimeall                 int,
Othernxtresp                        int,
Othernxtdownflow                    int,
Othernxtdowntime                    int,
OthernxtFlow                        int,
OthernxtTime                        int,
Otheryjtsucc                        int,
Otheryjtreq                         int,
Otheryjtresptimeall                 int,
Otheryjtresp                        int,
Otheryjtdownflow                    int,
Otheryjtdowntime                    int,
OtheryjtFlow                        int,
OtheryjtTime                        int,
internetvisits                      int,
miguvisits                          int,
internetbusiness                    int,
migubusiness                        int,
ServiceIMresptimeall                int
)PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/sgw_day_http';

drop table warnningtable;
CREATE EXTERNAL TABLE warnningtable(
City  int,
Cellid   bigint,
warnningtitle    string,
warnningtime     string,
effect           string
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/warnningtable';

drop table t_xdr_event_msg;
CREATE EXTERNAL TABLE t_xdr_event_msg(
City   int,
XDRID  string,
ProcedureStartTime bigint,
ttime string,
ProcedureEndTime  bigint,
IMSI             string,
IMEI             string,
TEtac             string,
msisdn              string,
Cellid           bigint,
SGW             string,
SP              string,
AppType         int,
AppSubtype      int,
AppStatus       int,
etype           string,
failurecase     string,
CELLREGION     string
)PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${WAREHOUSE}/t_xdr_event_msg';


drop table LTECELL;
create table LTECELL(
  MCC         int,
  MNC         INT,
  MMEGROUPID  INT,
  MMEID       int,
  ENODEBID    int,
  SITENAME    STRING,
  CELLNAME    STRING,
  LOCALCELLID int,
  CELLID      int,
  TAI         INT,
  PCI         INT,
  FREQ1       INT,
  FREQ2       INT,
  BANDWIDTH1  double,
  BANDWIDTH2  double,
  FREQCOUNT   INT,
  LONGITUDE   double,
  LATITUDE    double,
  SECTORTYPE  int,
  DOORTYPE    INT,
  TILTTOTAL   DOUBLE,
  TILTM       DOUBLE,
  TILTE       DOUBLE,
  AZIMUTH     DOUBLE,
  BEAMWIDTH   DOUBLE,
  VBEAMWIDTH  DOUBLE,
  AHEIGHT     DOUBLE,
  CITY        string,
  COMPANY     string,
  REGION      string,
  ENBTYPE     string,
  ENBVERSION  string
  )ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--门限配置表
 drop table if exists gt_capacity_config;
 create table if not exists gt_capacity_config(
        sub_pulse_limit int,
        non_gtsubpulse_commusers int,
        non_gtsubpuse_times int,
        over_pulse_timelen int,
        over_pulse_times int,
        short_pulse_timelen int,
        short_pulse_times int,
        balence_userrate int,
        balence_times int,
        highattach_users int,
        highattach_times int
 )
 PARTITIONED BY (
    dt string,
    h string
 )
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--负载均衡效果差小区天级表
drop table if exists gt_balence_baseday;
create table if not exists gt_balence_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        f1_f2 string,
        balenusesrateavg int,
        balenusersavg int
)
 PARTITIONED BY (
   dt string
 )
 ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--高铁用户脉冲时长超短小区表
drop table if exists gt_shorttimelen_baseday;
create table if not exists gt_shorttimelen_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        minpluse_timelen string,
        minhour int,
        maxpluse_timelen string,
        maxhour int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--高铁用户脉冲时长超长小区表
drop table if exists gt_overtimelen_baseday;
create table if not exists gt_overtimelen_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        minpluse_timelen int,
        minhour  int,
        maxpluse_timelen int,
        maxhour int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--平时普通用户多小区天级表
drop table if exists gt_commusermore_baseday;
create table if not exists gt_commusermore_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        maxusers int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

--高冲击小区维度天级详细表
drop table if exists gt_highattach_baseday;
create table if not exists gt_highattach_baseday(
        line_name  string,
        city string,
        ttime string,
        cellid int,
        cellname string,
        maxusers int
)
PARTITIONED BY (
    dt string
)
ROW FORMAT DELIMITED  FIELDS TERMINATED BY ',';

drop table if exists gt_pulse_load_balence60;
create table if not exists gt_pulse_load_balence60(
    ttime    string,
    hours    bigint,
    line    string,
    city    string,
    pulse_mark    bigint,
    cellprop    string,
    cellname    string,
    cellid    bigint,
    first_pulse_mark    bigint,
    pulse_timelen    bigint,
    pairname    string,
    f1users    bigint,
    f2users    bigint,
    balusers    bigint,
    balratio    double
)PARTITIONED BY (
       dt string,
       h string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ;

drop table if exists gt_balence_pair;
create table if not exists gt_balence_pair(
        line    string,
        city    string,
        scellname    string,
        scellid    bigint,
        sfreq    string,
        dcellname    string,
        dcellid    bigint,
        pairname    string,
        dfreq    string
)ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ;

drop table if exists tb_xdr_ifc_s1mme;
CREATE EXTERNAL TABLE tb_xdr_ifc_s1mme(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus int,
  requestcause int,
  failurecause int,
  keyword1 int,
  keyword2 int,
  keyword3 int,
  keyword4 int,
  mmeues1apid int,
  oldmmegroupid int,
  oldmmecode int,
  oldmtmsi int,
  mmegroupid int,
  mmecode int,
  mtmsi int,
  tmsi int,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  enbipadd string,
  mmeport int,
  enbport int,
  tac int,
  cellid int,
  othertac int,
  othereci int,
  apn string,
  epsbearernumber int,
  bearer0id int,
  bearer0type int,
  bearer0qci int,
  bearer0status int,
  bearer0requestcause int,
  bearer0failurecause int,
  bearer0enbgtpteid int,
  bearer0sgwgtpteid int,
  bearer1id int,
  bearer1type int,
  bearer1qci int,
  bearer1status int,
  bearer1requestcause int,
  bearer1failurecause int,
  bearer1enbgtpteid int,
  bearer1sgwgtpteid int,
  bearer2id int,
  bearer2type int,
  bearer2qci int,
  bearer2status int,
  bearer2requestcause int,
  bearer2failurecause int,
  bearer2enbgtpteid int,
  bearer2sgwgtpteid int,
  bearer3id int,
  bearer3type int,
  bearer3qci int,
  bearer3status int,
  bearer3requestcause int,
  bearer3failurecause int,
  bearer3enbgtpteid int,
  bearer3sgwgtpteid int,
  bearer4id int,
  bearer4type int,
  bearer4qci int,
  bearer4status int,
  bearer4requestcause int,
  bearer4failurecause int,
  bearer4enbgtpteid int,
  bearer4sgwgtpteid int,
  bearer5id int,
  bearer5type int,
  bearer5qci int,
  bearer5status int,
  bearer5requestcause int,
  bearer5failurecause int,
  bearer5enbgtpteid int,
  bearer5sgwgtpteid int,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_S1MME' ;

drop table if exists tb_xdr_ifc_x2;
  CREATE EXTERNAL TABLE tb_xdr_ifc_x2(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  cellid bigint,
  targetcellid bigint,
  enbid bigint,
  targetenbid bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  requestcause bigint,
  failurecause bigint,
  epsbearernumber bigint,
  bearer0id bigint,
  bearer0status bigint,
  bearer1id bigint,
  bearer1status bigint,
  bearer2id bigint,
  bearer2status bigint,
  bearer3id bigint,
  bearer3status bigint,
  bearer4id bigint,
  bearer4status bigint,
  bearer5id bigint,
  bearer5status bigint,
  bearer6id bigint,
  bearer6status bigint,
  bearer7id bigint,
  bearer7status bigint,
  bearer8id bigint,
  bearer8status bigint,
  bearer9id bigint,
  bearer9status bigint,
  bearer10id bigint,
  bearer10status bigint,
  bearer11id bigint,
  bearer11status bigint,
  bearer12id bigint,
  bearer12status bigint,
  bearer13id bigint,
  bearer13status bigint,
  bearer14id bigint,
  bearer14status bigint,
  bearer15id bigint,
  bearer15status bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_X2' ;

drop table if exists tb_xdr_ifc_gxrx;
CREATE EXTERNAL TABLE tb_xdr_ifc_gxrx(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  icid string,
  originrealm string,
  destinationrealm string,
  originhost string,
  destinationhost string,
  sgsnsgwsigip string,
  afappid string,
  ccrequesttype bigint,
  rxrequesttype bigint,
  mediatype bigint,
  abortcause bigint,
  resultcode bigint,
  experimentalresultcode bigint,
  sessionreleasecause bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_GXRX' ;

drop table if exists tb_xdr_ifc_http;
  CREATE EXTERNAL TABLE tb_xdr_ifc_http(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior int,
  wtpinterrupttype int,
  wtpinterruptcause int,
  title string,
  keyword string,
  busconductlogo int,
  buscompletionflag int,
  busrede int,
  browsingtool int,
  portalapp int,
  parentxdrid string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/tb_xdr_ifc_s1u_http_new' ;

drop table if exists mr_gt_grid_ana_base60;
CREATE TABLE mr_gt_grid_ana_base60(
  cellid int, 
  rruid string, 
  gridid int, 
  ttime string, 
  dir_state int, 
  elong int, 
  elat int, 
  avgrsrpx int, 
  commy int, 
  avgrsrqx int, 
  ltecoverratex int, 
  weakcoverratex int, 
  overlapcoverratex int, 
  overlapcoverratey int, 
  upsigrateavgx int, 
  upsigrateavgy int, 
  updiststrox int, 
  updiststroy int, 
  model3diststrox int, 
  model3diststroy int, 
  uebootx int, 
  uebooty int)
PARTITIONED BY ( 
  dt string, 
  h string)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_grid_ana_baseday;
  CREATE TABLE mr_gt_grid_ana_baseday(
  cellid int, 
  rruid string, 
  gridid int, 
  ttime string, 
  dir_state int, 
  elong int, 
  elat int, 
  avgrsrpx int, 
  commy int, 
  avgrsrqx int, 
  ltecoverratex int, 
  weakcoverratex int, 
  overlapcoverratex int, 
  overlapcoverratey int, 
  upsigrateavgx int, 
  upsigrateavgy int, 
  updiststrox int, 
  updiststroy int, 
  model3diststrox int, 
  model3diststroy int, 
  uebootx int, 
  uebooty int)
PARTITIONED BY ( 
  dt string
)
ROW FORMAT DELIMITED 
  FIELDS TERMINATED BY ',';

drop table if exists volte_gt_cell_ana_base60;
CREATE TABLE volte_gt_cell_ana_base60(
  TTIME                  string,
  CELLID                 int,
  DIR_STATE              int,
  VOLTEMCSUCC            int,
  VOLTEMCATT             int,
  VOLTEVDSUCC            int,
  VOLTEVDATT             int,
  VOLTETIME              int,
  VOLTEMCTIME            int,
  VOLTEVDTIME            int,
  VOLTEMCHANDOVER        int,
  VOLTEANSWER            int,
  VOLTEVDHANDOVER        int,
  VOLTEVDANSWER          int,
  SRVCCSUCC              int,
  SRVCCATT               int,
  SRVCCTIME              int,
  LTESWSUCC              int,
  LTESWATT               int,
  SRQATT                 int,
  SRQSUCC                int,
  TAUATT                 int,
  TAUSUCC                int,
  RRCREBUILD             int,
  RRCSUCC                int,
  RRCREQ                 int,
  IMSIREGATT             int,
  IMSIREGSUCC            int,
  WIRELESSDROP           int,
  WIRELESS               int,
  EABDROP                int,
  EAB                    int,
  EABS1SWX               int,
  EABS1SWY               int,
  S1TOX2SWX              int,
  S1TOX2SWY              int,
  ENBX2SWX               int,
  ENBX2SWY               int,
  UUENBSWX               int,
  UUENBSWY               int,
  UUENBINX               int,
  UUENBINY               int,
  SWX                    int,
  SWY                    int,
  ATTACHX                int,
  ATTACHY                int,
  PAGEREQ                int,
  PAGERESP               int,
  PAGESHOWTIMEALL        int,
  PAGERESPTIMEALL        int,
  PAGESHOWSUCC           int,
  HTTPDOWNFLOW           int,
  HTTPDOWNTIME           int,
  MEDIAREQ               int,
  MEDIASUCC              int,
  MEDIADOWNFLOW          int,
  MEDIADOWNTIME          int,
  BROWSEDOWNLOADVISITS   int,
  VIDEOSERVICEVISITS     int,
  INSTANTMESSAGEVISITS   int,
  APPVISITS              int,
  BROWSEDOWNLOADBUSINESS int,
  VIDEOSERVICEBUSINESS   int,
  INSTANTMESSAGEBUSINESS int,
  APPBUSINESS            int
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';


drop table if exists volte_gt_cell_ana_baseday;
CREATE TABLE volte_gt_cell_ana_baseday(
  TTIME                  string,
  CELLID                 int,
  DIR_STATE              int,
  VOLTEMCSUCC            int,
  VOLTEMCATT             int,
  VOLTEVDSUCC            int,
  VOLTEVDATT             int,
  VOLTETIME              int,
  VOLTEMCTIME            int,
  VOLTEVDTIME            int,
  VOLTEMCHANDOVER        int,
  VOLTEANSWER            int,
  VOLTEVDHANDOVER        int,
  VOLTEVDANSWER          int,
  SRVCCSUCC              int,
  SRVCCATT               int,
  SRVCCTIME              int,
  LTESWSUCC              int,
  LTESWATT               int,
  SRQATT                 int,
  SRQSUCC                int,
  TAUATT                 int,
  TAUSUCC                int,
  RRCREBUILD             int,
  RRCSUCC                int,
  RRCREQ                 int,
  IMSIREGATT             int,
  IMSIREGSUCC            int,
  WIRELESSDROP           int,
  WIRELESS               int,
  EABDROP                int,
  EAB                    int,
  EABS1SWX               int,
  EABS1SWY               int,
  S1TOX2SWX              int,
  S1TOX2SWY              int,
  ENBX2SWX               int,
  ENBX2SWY               int,
  UUENBSWX               int,
  UUENBSWY               int,
  UUENBINX               int,
  UUENBINY               int,
  SWX                    int,
  SWY                    int,
  ATTACHX                int,
  ATTACHY                int,
  PAGEREQ                int,
  PAGERESP               int,
  PAGESHOWTIMEALL        int,
  PAGERESPTIMEALL        int,
  PAGESHOWSUCC           int,
  HTTPDOWNFLOW           int,
  HTTPDOWNTIME           int,
  MEDIAREQ               int,
  MEDIASUCC              int,
  MEDIADOWNFLOW          int,
  MEDIADOWNTIME          int,
  BROWSEDOWNLOADVISITS   int,
  VIDEOSERVICEVISITS     int,
  INSTANTMESSAGEVISITS   int,
  APPVISITS              int,
  BROWSEDOWNLOADBUSINESS int,
  VIDEOSERVICEBUSINESS   int,
  INSTANTMESSAGEBUSINESS int,
  APPBUSINESS            int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table if exists volte_gt_user_ana_base60;
CREATE TABLE volte_gt_user_ana_base60(
  IMSI                   string,
  IMEI                   string,
  MSISDN                 string,
  CELLID                 int,
  TTIME                  string,
  DIR_STATE              int,
  VOLTEMCSUCC            int,
  VOLTEMCATT             int,
  VOLTEVDSUCC            int,
  VOLTEVDATT             int,
  VOLTETIME              int,
  VOLTEMCTIME            int,
  VOLTEVDTIME            int,
  VOLTEMCHANDOVER        int,
  VOLTEANSWER            int,
  VOLTEVDHANDOVER        int,
  VOLTEVDANSWER          int,
  SRVCCSUCC              int,
  SRVCCATT               int,
  SRVCCTIME              int,
  LTESWSUCC              int,
  LTESWATT               int,
  SRQATT                 int,
  SRQSUCC                int,
  TAUATT                 int,
  TAUSUCC                int,
  RRCREBUILD             int,
  RRCSUCC                int,
  RRCREQ                 int,
  IMSIREGATT             int,
  IMSIREGSUCC            int,
  WIRELESSDROP           int,
  WIRELESS               int,
  EABDROP                int,
  EAB                    int,
  EABS1SWX               int,
  EABS1SWY               int,
  S1TOX2SWX              int,
  S1TOX2SWY              int,
  ENBX2SWX               int,
  ENBX2SWY               int,
  UUENBSWX               int,
  UUENBSWY               int,
  UUENBINX               int,
  UUENBINY               int,
  SWX                    int,
  SWY                    int,
  ATTACHX                int,
  ATTACHY                int,
  PAGEREQ                int,
  PAGERESP               int,
  PAGESHOWTIMEALL        int,
  PAGERESPTIMEALL        int,
  PAGESHOWSUCC           int,
  HTTPDOWNFLOW           int,
  HTTPDOWNTIME           int,
  MEDIAREQ               int,
  MEDIASUCC              int,
  MEDIADOWNFLOW          int,
  MEDIADOWNTIME          int,
  BROWSEDOWNLOADVISITS   int,
  VIDEOSERVICEVISITS     int,
  INSTANTMESSAGEVISITS   int,
  APPVISITS              int,
  BROWSEDOWNLOADBUSINESS int,
  VIDEOSERVICEBUSINESS   int,
  INSTANTMESSAGEBUSINESS int,
  APPBUSINESS            int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists volte_gt_user_ana_baseday;
CREATE TABLE volte_gt_user_ana_baseday(
   IMSI                   string,
  IMEI                   string,
  MSISDN                 string,
  CELLID                 int,
  TTIME                  string,
  DIR_STATE              int,
  VOLTEMCSUCC            int,
  VOLTEMCATT             int,
  VOLTEVDSUCC            int,
  VOLTEVDATT             int,
  VOLTETIME              int,
  VOLTEMCTIME            int,
  VOLTEVDTIME            int,
  VOLTEMCHANDOVER        int,
  VOLTEANSWER            int,
  VOLTEVDHANDOVER        int,
  VOLTEVDANSWER          int,
  SRVCCSUCC              int,
  SRVCCATT               int,
  SRVCCTIME              int,
  LTESWSUCC              int,
  LTESWATT               int,
  SRQATT                 int,
  SRQSUCC                int,
  TAUATT                 int,
  TAUSUCC                int,
  RRCREBUILD             int,
  RRCSUCC                int,
  RRCREQ                 int,
  IMSIREGATT             int,
  IMSIREGSUCC            int,
  WIRELESSDROP           int,
  WIRELESS               int,
  EABDROP                int,
  EAB                    int,
  EABS1SWX               int,
  EABS1SWY               int,
  S1TOX2SWX              int,
  S1TOX2SWY              int,
  ENBX2SWX               int,
  ENBX2SWY               int,
  UUENBSWX               int,
  UUENBSWY               int,
  UUENBINX               int,
  UUENBINY               int,
  SWX                    int,
  SWY                    int,
  ATTACHX                int,
  ATTACHY                int,
  PAGEREQ                int,
  PAGERESP               int,
  PAGESHOWTIMEALL        int,
  PAGERESPTIMEALL        int,
  PAGESHOWSUCC           int,
  HTTPDOWNFLOW           int,
  HTTPDOWNTIME           int,
  MEDIAREQ               int,
  MEDIASUCC              int,
  MEDIADOWNFLOW          int,
  MEDIADOWNTIME          int,
  BROWSEDOWNLOADVISITS   int,
  VIDEOSERVICEVISITS     int,
  INSTANTMESSAGEVISITS   int,
  APPVISITS              int,
  BROWSEDOWNLOADBUSINESS int,
  VIDEOSERVICEBUSINESS   int,
  INSTANTMESSAGEBUSINESS int,
  APPBUSINESS            int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_cell_ana_base60;
CREATE TABLE mr_gt_cell_ana_base60(
  cellid int,
  ttime string,
  dir_state int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_cell_ana_baseday;
CREATE TABLE mr_gt_cell_ana_baseday(
  cellid int,
  ttime string,
  dir_state int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

drop table if exists mr_gt_user_ana_base60;
CREATE TABLE mr_gt_user_ana_base60(
  imsi string,
  imei string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  elong int,
  elat int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table if exists mr_gt_user_ana_baseday;
CREATE TABLE mr_gt_user_ana_baseday(
  imsi string,
  imei string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  elong int,
  elat int,
  avgrsrpx int,
  commy int,
  avgrsrqx int,
  ltecoverratex int,
  weakcoverratex int,
  overlapcoverratex int,
  overlapcoverratey int,
  upsigrateavgx int,
  upsigrateavgy int,
  updiststrox int,
  updiststroy int,
  model3diststrox int,
  model3diststroy int,
  uebootx int,
  uebooty int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',' ;

--山西现场KPI
drop table if exists sh_tb_xdr_ifc_dns;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_dns(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid string,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum int,
  tcplinkstatus int,
  sessionflag int,
  reqdns string,
  resultip string,
  dnsrecode bigint,
  dnsattnum bigint,
  dnsrenum bigint,
  licensedconnum bigint,
  additionalconnum bigint,
  parentxdrid string)
 PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/dns';

--山西现场KPI
drop table if exists sh_tb_xdr_ifc_email;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_email(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  emailtranstype bigint,
  restatuscode bigint,
  username string,
  sender string,
  email string,
  smtpaddr string,
  recipacc string,
  messheadinfor string,
  accesstype int,
  parentxdrid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/email';

--山西现场KPI
drop table if exists sh_tb_xdr_ifc_http;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_http(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior int,
  wtpinterrupttype int,
  wtpinterruptcause int,
  title string,
  keyword string,
  busconductlogo int,
  buscompletionflag int,
  busrede int,
  browsingtool int,
  portalapp int,
  parentxdrid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/http';

--山西现场kpi
drop table if exists sh_tb_xdr_ifc_mms;
CREATE EXTERNAL TABLE sh_tb_xdr_ifc_mms(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  transtype int,
  successflag int,
  httporwap1x int,
  httpwapcode bigint,
  mmserspstatus bigint,
  mmssendaddr string,
  mmsmsgid string,
  mmstransactionid string,
  mmsretriveaddr string,
  mmsretriveaddrnum bigint,
  mmsccbccaddr string,
  mmsccbccaddrnum bigint,
  mmssubject string,
  mmsdatasize bigint,
  mmscipaddr string,
  host string,
  uri string,
  xonlinehost string,
  parentxdrid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/mms';

--山西现场KPI
drop table if exists t_pub_option_failcause;
CREATE EXTERNAL TABLE t_pub_option_failcause(
  option_definition_id bigint,
  option_code string,
  option_desc string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/t_pub_option_failcause';

--山西现场
drop table if exists tb_xdr_ifc_s1mme_new;
CREATE TABLE tb_xdr_ifc_s1mme_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus int,
  requestcause int,
  failurecause int,
  keyword1 int,
  keyword2 int,
  keyword3 int,
  keyword4 int,
  mmeues1apid int,
  oldmmegroupid int,
  oldmmecode int,
  oldmtmsi int,
  mmegroupid int,
  mmecode int,
  mtmsi int,
  tmsi int,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  enbipadd string,
  mmeport int,
  enbport int,
  tac int,
  cellid int,
  othertac int,
  othereci int,
  apn string,
  epsbearernumber int,
  bearer0id int,
  bearer0type int,
  bearer0qci int,
  bearer0status int,
  bearer0requestcause int,
  bearer0failurecause int,
  bearer0enbgtpteid int,
  bearer0sgwgtpteid int,
  bearer1id int,
  bearer1type int,
  bearer1qci int,
  bearer1status int,
  bearer1requestcause int,
  bearer1failurecause int,
  bearer1enbgtpteid int,
  bearer1sgwgtpteid int,
  bearer2id int,
  bearer2type int,
  bearer2qci int,
  bearer2status int,
  bearer2requestcause int,
  bearer2failurecause int,
  bearer2enbgtpteid int,
  bearer2sgwgtpteid int,
  bearer3id int,
  bearer3type int,
  bearer3qci int,
  bearer3status int,
  bearer3requestcause int,
  bearer3failurecause int,
  bearer3enbgtpteid int,
  bearer3sgwgtpteid int,
  bearer4id int,
  bearer4type int,
  bearer4qci int,
  bearer4status int,
  bearer4requestcause int,
  bearer4failurecause int,
  bearer4enbgtpteid int,
  bearer4sgwgtpteid int,
  bearer5id int,
  bearer5type int,
  bearer5qci int,
  bearer5status int,
  bearer5requestcause int,
  bearer5failurecause int,
  bearer5enbgtpteid int,
  bearer5sgwgtpteid int,
  rangetime string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_sgs;
CREATE EXTERNAL TABLE tb_xdr_ifc_sgs(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  sgscause bigint,
  rejectcause bigint,
  cpcause bigint,
  rpcause bigint,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  mscserveripadd string,
  mmeport bigint,
  mscserverport bigint,
  serviceindicator bigint,
  mmename string,
  tmsi bigint,
  newlac bigint,
  oldlac bigint,
  tac bigint,
  cellid bigint,
  callingid string,
  vlrnamelength bigint,
  vlrname string,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_SGS';

--山西现场
drop table if exists tb_xdr_ifc_sv;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport bigint,
  destneip string,
  destneport bigint,
  roamdirection bigint,
  homemcc bigint,
  homemnc bigint,
  mcc bigint,
  mnc bigint,
  targetlac bigint,
  sourcetac bigint,
  sourceeci bigint,
  svflags bigint,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid bigint,
  dlcmmeteid bigint,
  stnsr string,
  targetrncid bigint,
  targetcellid bigint,
  arp bigint,
  requestresult bigint,
  result bigint,
  svcause bigint,
  postfailurecause bigint,
  respdelay bigint,
  svdelay bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_SV';

--山西现场
drop table if exists tb_xdr_ifc_uu_new;
CREATE TABLE tb_xdr_ifc_uu_new(
  length bigint,
  city string,
  interface int,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  keyword1 int,
  keyword2 int,
  procedurestatus int,
  plmnid string,
  enbid bigint,
  cellid bigint,
  crnti bigint,
  targetenbid bigint,
  targetcellid bigint,
  targetcrnti bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  mtmsi bigint,
  csfbindication bigint,
  redirectednetwork bigint,
  epsbearernumber int,
  bearer0id bigint,
  bearer0status bigint,
  bearer1id bigint,
  bearer1status bigint,
  bearer2id bigint,
  bearer2status bigint,
  bearer3id bigint,
  bearer3status bigint,
  bearer4id bigint,
  bearer4status bigint,
  bearer5id bigint,
  bearer5status bigint,
  bearer6id bigint,
  bearer6status bigint,
  bearer7id bigint,
  bearer7status bigint,
  bearer8id bigint,
  bearer8status bigint,
  bearer9id bigint,
  bearer9status bigint,
  bearer10id string,
  bearer10status string,
  bearer11id string,
  bearer11status string,
  bearer12id string,
  bearer12status string,
  bearer13id string,
  bearer13status string,
  bearer14id string,
  bearer14status string,
  bearer15id string,
  bearer15status string,
  rangetime string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_x2_new;
CREATE TABLE tb_xdr_ifc_x2_new(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  cellid bigint,
  targetcellid bigint,
  enbid bigint,
  targetenbid bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  requestcause bigint,
  failurecause bigint,
  epsbearernumber bigint,
  bearer0id bigint,
  bearer0status bigint,
  bearer1id bigint,
  bearer1status bigint,
  bearer2id bigint,
  bearer2status bigint,
  bearer3id bigint,
  bearer3status bigint,
  bearer4id bigint,
  bearer4status bigint,
  bearer5id bigint,
  bearer5status bigint,
  bearer6id bigint,
  bearer6status bigint,
  bearer7id bigint,
  bearer7status bigint,
  bearer8id bigint,
  bearer8status bigint,
  bearer9id bigint,
  bearer9status bigint,
  bearer10id bigint,
  bearer10status bigint,
  bearer11id bigint,
  bearer11status bigint,
  bearer12id bigint,
  bearer12status bigint,
  bearer13id bigint,
  bearer13status bigint,
  bearer14id bigint,
  bearer14status bigint,
  bearer15id bigint,
  bearer15status bigint,
  rangetime string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists grid_rru;
CREATE TABLE grid_rru(
  gridid int,
  rruid string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_gmmwmgmimjisc_new;
CREATE TABLE tb_xdr_ifc_gmmwmgmimjisc_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  servicetype int,
  procedurestatus int,
  callingnumber string,
  callednumber string,
  callingpartyuri string,
  requesturi string,
  userip string,
  callid string,
  icid string,
  sourceneip string,
  sourceneport int,
  destneip string,
  destneport int,
  callside int,
  sourceaccesstype int,
  sourceeci int,
  sourcetac int,
  sourceimsi string,
  sourceimei string,
  destaccesstype int,
  desteci int,
  desttac int,
  destimsi string,
  destimei string,
  authtype int,
  expirestimereq int,
  expirestimersp int,
  callingsdpipaddr string,
  callingaudiosdpport int,
  callingvideosdpport int,
  calledsdpipaddr string,
  calledaudiosdpport int,
  calledvideoport int,
  audiocodec int,
  videocodec int,
  redirectingpartyaddress string,
  originalpartyaddress string,
  redirectreason int,
  responsecode int,
  finishwarningcode int,
  finishreasonprotocol int,
  finishreasoncause int,
  firfailtime int,
  firstfailneip string,
  alertingtime int,
  answertime int,
  releasetime int,
  callduration int,
  authreqtime int,
  authrsptime int,
  stnsr string,
  atcfmgmt string,
  atusti string,
  cmsisdn string,
  ssi string,
  rangetime string,
  etype int,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_gxrx_new;
CREATE EXTERNAL TABLE tb_xdr_ifc_gxrx_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  icid string,
  originrealm string,
  destinationrealm string,
  originhost string,
  destinationhost string,
  sgsnsgwsigip string,
  afappid string,
  ccrequesttype int,
  rxrequesttype int,
  mediatype int,
  abortcause int,
  resultcode int,
  experimentalresultcode int,
  sessionreleasecause int,
  rangetime string,
  etype int,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/gxrx';

--山西现场
drop table if exists tb_xdr_ifc_s1u_common_new;
CREATE TABLE tb_xdr_ifc_s1u_common_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_dns_new;
CREATE TABLE tb_xdr_ifc_s1u_dns_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  reqdns string,
  resultip string,
  dnsrecode bigint,
  dnsattnum bigint,
  dnsrenum bigint,
  licensedconnum bigint,
  additionalconnum bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_email_new;
CREATE TABLE tb_xdr_ifc_s1u_email_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  emailtranstype bigint,
  restatuscode bigint,
  username string,
  sender string,
  email string,
  smtpaddr string,
  recipacc string,
  messheadinfor string,
  accesstype bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_ftp_new;
CREATE TABLE tb_xdr_ifc_s1u_ftp_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  ftpstatus bigint,
  loginuser string,
  currentdirectory string,
  filetransfermode bigint,
  transdirectflag bigint,
  filename string,
  ftplocdataport bigint,
  ftpremdataport bigint,
  totalfilesize bigint,
  ftprede bigint,
  transdura bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_http_new;
CREATE TABLE tb_xdr_ifc_s1u_http_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior bigint,
  wtpinterrupttype bigint,
  wtpinterruptcause bigint,
  title string,
  keyword string,
  busconductlogo bigint,
  buscompletionflag bigint,
  busrede bigint,
  browsingtool bigint,
  portalapp bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_mms_new;
CREATE TABLE tb_xdr_ifc_s1u_mms_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  transtype bigint,
  successflag bigint,
  httporwap1x bigint,
  httpwapcode bigint,
  mmserspstatus bigint,
  mmssendaddr string,
  mmsmsgid string,
  mmstransactionid string,
  mmsretriveaddr string,
  mmsretriveaddrnum bigint,
  mmsccbccaddr string,
  mmsccbccaddrnum bigint,
  mmssubject string,
  mmsdatasize bigint,
  mmscipaddr string,
  host string,
  uri string,
  xonlinehost string,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_p2p_new;
CREATE TABLE tb_xdr_ifc_s1u_p2p_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid string,
  tac string,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  filesize bigint,
  p2psign string,
  tracker string,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_rtcomm_new;
CREATE TABLE tb_xdr_ifc_s1u_rtcomm_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid string,
  tac string,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  rtcomm string,
  appversion string,
  clversion string,
  opertype bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_rtsp_new;
CREATE TABLE tb_xdr_ifc_s1u_rtsp_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid string,
  sgwgtpteid string,
  tac string,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  rtspurl string,
  useragent string,
  rtpip string,
  rtpstartclport bigint,
  rtpendclport bigint,
  rtpstartserport bigint,
  rtpendserport bigint,
  rtspvidstream bigint,
  rtspaudstream bigint,
  rtsprede bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_s1u_voip_new;
CREATE TABLE tb_xdr_ifc_s1u_voip_new(
  length bigint,
  city bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei bigint,
  msisdn string,
  machineipaddtype bigint,
  sgwipaddr string,
  enbipaddr string,
  sgwport bigint,
  enbport bigint,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent bigint,
  appstatus bigint,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal bigint,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag bigint,
  calldirection bigint,
  callernum string,
  callednum string,
  calltype bigint,
  voipstreamsnum bigint,
  reasonhook bigint,
  signprotype bigint,
  updown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--山西现场
drop table if exists tb_xdr_ifc_sgs_new;
CREATE EXTERNAL TABLE tb_xdr_ifc_sgs_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus int,
  sgscause int,
  rejectcause int,
  cpcause int,
  rpcause int,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  mscserveripadd string,
  mmeport int,
  mscserverport int,
  serviceindicator int,
  mmename string,
  tmsi int,
  newlac int,
  oldlac int,
  tac int,
  cellid int,
  callingid string,
  vlrnamelength int,
  vlrname string,
  rangetime string,
  etype int,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/sgs';

--山西现场
drop table if exists tb_xdr_ifc_sv_new;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv_new(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport int,
  destneip string,
  destneport int,
  roamdirection int,
  homemcc int,
  homemnc int,
  mcc int,
  mnc int,
  targetlac int,
  sourcetac int,
  sourceeci int,
  svflags int,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid int,
  dlcmmeteid int,
  stnsr string,
  targetrncid int,
  targetcellid int,
  arp int,
  requestresult int,
  result int,
  svcause int,
  postfailurecause int,
  respdelay int,
  svdelay int,
  rangetime string,
  etype int,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int,
  echksvtype int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/output/xdrnew/sv_xdr';

--山西现场
drop table if exists tb_xdr_ifc_uu_new_sk;
CREATE EXTERNAL TABLE tb_xdr_ifc_uu_new_sk(
  length bigint,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  keyword1 int,
  keyword2 int,
  procedurestatus int,
  plmnid string,
  enbid int,
  cellid int,
  crnti int,
  targetenbid int,
  targetcellid int,
  targetcrnti int,
  mmeues1apid int,
  mmegroupid int,
  mmecode int,
  mtmsi int,
  csfbindication int,
  epsbearernumber int,
  bearer0id int,
  bearer0status int,
  bearer1id int,
  bearer1status int,
  bearer2id int,
  bearer2status int,
  bearer3id int,
  bearer3status int,
  bearer4id int,
  bearer4status int,
  bearer5id int,
  bearer5status int,
  rangetime string,
  etype int,
  gridid int,
  slong string,
  slat string,
  dlong string,
  dlat string,
  distance string,
  espeed string,
  elong string,
  elat string,
  falurecause string,
  flag int,
  beforeflag int,
  eupordown int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${DB_PATH}/TB_XDR_IFC_UU';

drop table if exists cell_mr;
CREATE TABLE cell_mr(
  objectid string,
  vid bigint,
  fileformatversion string,
  starttime bigint,
  endtime bigint,
  period bigint,
  enbid bigint,
  userlabel string,
  mrname string,
  cellid bigint,
  earfcn bigint,
  subframenbr bigint,
  prbnbr bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  meatime string,
  eventtype string,
  gridcenterlongitude string,
  gridcenterlatitude string,
  kpi1 bigint,
  kpi2 bigint,
  kpi3 bigint,
  kpi4 bigint,
  kpi5 bigint,
  kpi6 bigint,
  kpi7 bigint,
  kpi8 bigint,
  kpi9 bigint,
  kpi10 bigint,
  kpi11 bigint,
  kpi12 bigint,
  kpi13 bigint,
  kpi14 bigint,
  kpi15 bigint,
  kpi16 bigint,
  kpi17 bigint,
  kpi18 bigint,
  kpi19 bigint,
  kpi20 bigint,
  kpi21 bigint,
  kpi22 bigint,
  kpi23 bigint,
  kpi24 bigint,
  kpi25 bigint,
  kpi26 bigint,
  kpi27 bigint,
  kpi28 bigint,
  kpi29 bigint,
  kpi30 bigint,
  kpi31 bigint,
  kpi32 bigint,
  kpi33 bigint,
  kpi34 bigint,
  kpi35 bigint,
  kpi36 bigint,
  kpi37 bigint,
  kpi38 bigint,
  kpi39 bigint,
  kpi40 bigint,
  kpi41 bigint,
  kpi42 bigint,
  kpi43 bigint,
  kpi44 bigint,
  kpi45 bigint,
  kpi46 bigint,
  kpi47 bigint,
  kpi48 bigint,
  kpi49 bigint,
  kpi50 bigint,
  kpi51 bigint,
  kpi52 bigint,
  kpi53 bigint,
  kpi54 bigint,
  kpi55 bigint,
  kpi56 bigint,
  kpi57 bigint,
  kpi58 bigint,
  kpi59 bigint,
  kpi60 bigint,
  kpi61 bigint,
  kpi62 bigint,
  kpi63 bigint,
  kpi64 bigint,
  kpi65 bigint,
  kpi66 bigint,
  kpi67 bigint,
  kpi68 bigint,
  kpi69 bigint,
  kpi70 bigint,
  kpi71 bigint,
  length bigint,
  city string,
  xdrtype bigint,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  mrtype bigint,
  neighborcellnumber bigint,
  gsmneighborcellnumber bigint,
  tdsneighborcellnumber bigint,
  v_enb bigint,
  mrtime bigint)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';



--高铁用户识别表
drop table if exists volte_gtuser_data;
create EXTERNAL table if not exists volte_gtuser_data(
imsi string,
cellid string,
ttime string
)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
location '/${DB_PATH}/volte_gtuser_data' ;

--20170606山西现场
drop table  kpi_mid_cell_day;
CREATE TABLE kpi_mid_cell_day(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table  kpi_mid_cell_hour;
CREATE TABLE kpi_mid_cell_hour(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';


drop  table kpi_mid_imsi_cell_day;
 CREATE TABLE kpi_mid_imsi_cell_day(
  ttime string,
  imsi string,
  msisdn string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table kpi_mid_imsi_cell_hour;
CREATE TABLE kpi_mid_imsi_cell_hour(
  ttime string,
  imsi string,
  msisdn string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_cell_day;
  CREATE TABLE mro_kpi_mid_cell_day(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_cell_grid_day;
 CREATE TABLE mro_kpi_mid_cell_grid_day(
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';


drop table mro_kpi_mid_cell_grid_hour;
  CREATE TABLE mro_kpi_mid_cell_grid_hour(
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_cell_hour;
  CREATE TABLE mro_kpi_mid_cell_hour(
  ttime string,
  cellid int,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_imsi_cell_grid_day;
  CREATE TABLE mro_kpi_mid_imsi_cell_grid_day(
  imsi string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

drop table mro_kpi_mid_imsi_cell_grid_hour;
  CREATE TABLE mro_kpi_mid_imsi_cell_grid_hour(
  imsi string,
  msisdn string,
  cellid int,
  rruid string,
  gridid int,
  ttime string,
  dir_state int,
  kpi001 int,
  kpi002 int,
  kpi003 int,
  kpi004 int,
  kpi005 int,
  kpi006 int,
  kpi007 int,
  kpi008 int,
  kpi009 int,
  kpi010 int,
  kpi011 int,
  kpi012 int,
  kpi013 int,
  kpi014 int,
  kpi015 int,
  kpi016 int,
  kpi017 int,
  kpi018 int,
  kpi019 int,
  kpi020 int,
  kpi021 int,
  kpi022 int,
  kpi023 int,
  kpi024 int,
  kpi025 int,
  kpi026 int,
  kpi027 int,
  kpi028 int,
  kpi029 int,
  kpi030 int,
  kpi031 int,
  kpi032 int,
  kpi033 int,
  kpi034 int,
  kpi035 int,
  kpi036 int,
  kpi037 int,
  kpi038 int,
  kpi039 int,
  kpi040 int,
  kpi041 int,
  kpi042 int,
  kpi043 int,
  kpi044 int,
  kpi045 int,
  kpi046 int,
  kpi047 int,
  kpi048 int,
  kpi049 int,
  kpi050 int,
  kpi051 int,
  kpi052 int,
  kpi053 int,
  kpi054 int,
  kpi055 int,
  kpi056 int,
  kpi057 int,
  kpi058 int,
  kpi059 int,
  kpi060 int,
  kpi061 int,
  kpi062 int,
  kpi063 int,
  kpi064 int,
  kpi065 int,
  kpi066 int,
  kpi067 int,
  kpi068 int,
  kpi069 int,
  kpi070 int,
  kpi071 int,
  kpi072 int,
  kpi073 int,
  kpi074 int,
  kpi075 int,
  kpi076 int,
  kpi077 int,
  kpi078 int,
  kpi079 int,
  kpi080 int,
  kpi081 int,
  kpi082 int,
  kpi083 int,
  kpi084 int,
  kpi085 int,
  kpi086 int,
  kpi087 int,
  kpi088 int,
  kpi089 int,
  kpi090 int,
  kpi091 int,
  kpi092 int,
  kpi093 int,
  kpi094 int,
  kpi095 int,
  kpi096 int,
  kpi097 int,
  kpi098 int,
  kpi099 int,
  kpi100 int,
  kpi101 int,
  kpi102 int,
  kpi103 int,
  kpi104 int,
  kpi105 int,
  kpi106 int,
  kpi107 int,
  kpi108 int,
  kpi109 int,
  kpi110 int,
  kpi111 int,
  kpi112 int,
  kpi113 int,
  kpi114 int,
  kpi115 int,
  kpi116 int,
  kpi117 int,
  kpi118 int,
  kpi119 int,
  kpi120 int,
  kpi121 int,
  kpi122 int,
  kpi123 int,
  kpi124 int,
  kpi125 int,
  kpi126 int,
  kpi127 int,
  kpi128 int,
  kpi129 int,
  kpi130 int,
  kpi131 int,
  kpi132 int,
  kpi133 int,
  kpi134 int,
  kpi135 int,
  kpi136 int,
  kpi137 int,
  kpi138 int,
  kpi139 int,
  kpi140 int,
  kpi141 int,
  kpi142 int,
  kpi143 int,
  kpi144 int,
  kpi145 int,
  kpi146 int,
  kpi147 int,
  kpi148 int,
  kpi149 int,
  kpi150 int,
  kpi151 int,
  kpi152 int,
  kpi153 int,
  kpi154 int,
  kpi155 int,
  kpi156 int,
  kpi157 int,
  kpi158 int,
  kpi159 int,
  kpi160 int,
  kpi161 int,
  kpi162 int,
  kpi163 int,
  kpi164 int,
  kpi165 int,
  kpi166 int,
  kpi167 int,
  kpi168 int,
  kpi169 int,
  kpi170 int,
  kpi171 int,
  kpi172 int,
  kpi173 int,
  kpi174 int,
  kpi175 int,
  kpi176 int,
  kpi177 int,
  kpi178 int,
  kpi179 int,
  kpi180 int,
  kpi181 int,
  kpi182 int,
  kpi183 int,
  kpi184 int,
  kpi185 int,
  kpi186 int,
  kpi187 int,
  kpi188 int,
  kpi189 int,
  kpi190 int,
  kpi191 int,
  kpi192 int,
  kpi193 int,
  kpi194 int,
  kpi195 int,
  kpi196 int,
  kpi197 int,
  kpi198 int,
  kpi199 int,
  kpi200 int,
  kpi201 int,
  kpi202 int,
  kpi203 int,
  kpi204 int,
  kpi205 int,
  kpi206 int,
  kpi207 int,
  kpi208 int,
  kpi209 int,
  kpi210 int,
  kpi211 int,
  kpi212 int,
  kpi213 int,
  kpi214 int,
  kpi215 int,
  kpi216 int,
  kpi217 int,
  kpi218 int,
  kpi219 int,
  kpi220 int,
  kpi221 int,
  kpi222 int,
  kpi223 int,
  kpi224 int,
  kpi225 int,
  kpi226 int,
  kpi227 int,
  kpi228 int,
  kpi229 int,
  kpi230 int,
  kpi231 int,
  kpi232 int,
  kpi233 int,
  kpi234 int,
  kpi235 int,
  kpi236 int,
  kpi237 int,
  kpi238 int,
  kpi239 int,
  kpi240 int,
  kpi241 int,
  kpi242 int,
  kpi243 int,
  kpi244 int,
  kpi245 int,
  kpi246 int,
  kpi247 int,
  kpi248 int,
  kpi249 int,
  kpi250 int,
  kpi251 int,
  kpi252 int,
  kpi253 int,
  kpi254 int,
  kpi255 int,
  kpi256 int,
  kpi257 int,
  kpi258 int,
  kpi259 int,
  kpi260 int,
  kpi261 int,
  kpi262 int,
  kpi263 int,
  kpi264 int,
  kpi265 int,
  kpi266 int,
  kpi267 int,
  kpi268 int,
  kpi269 int,
  kpi270 int,
  kpi271 int,
  kpi272 int,
  kpi273 int,
  kpi274 int,
  kpi275 int,
  kpi276 int,
  kpi277 int,
  kpi278 int,
  kpi279 int,
  kpi280 int,
  kpi281 int,
  kpi282 int,
  kpi283 int,
  kpi284 int,
  kpi285 int,
  kpi286 int,
  kpi287 int,
  kpi288 int,
  kpi289 int,
  kpi290 int,
  kpi291 int,
  kpi292 int,
  kpi293 int,
  kpi294 int,
  kpi295 int,
  kpi296 int,
  kpi297 int,
  kpi298 int,
  kpi299 int,
  kpi300 int)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ',';

--20170605新增
drop table VOLTE_GT_FREE_USER_DATA;
create EXTERNAL table VOLTE_GT_FREE_USER_DATA
(
  IMSI              string,
  CELLID             bigint,
  PROCEDURETYPE      int,
  PROCEDURESTATUS    int,
  RANGETIME          string,
  IMEI               string,
  MSISDN             string,
  PROCEDURESTARTTIME bigint,
  PROCEDUREENDTIME   bigint,
  DIR_STATE          int,
  SEQNUM             int,
  ISPUB              int
)
PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
location '/${DB_PATH}/FreeGtUser';

--20170605新增
drop table VOLTE_GT_BUSI_USER_DATA;
create EXTERNAL table VOLTE_GT_BUSI_USER_DATA
(
  IMSI               string,
  CELLID             bigint,
  TARGETCELLID       bigint,
  PROCEDURETYPE      bigint,
  PROCEDURESTATUS    bigint,
  RANGETIME          string,
  IMEI               string,
  MSISDN            string,
  PROCEDURESTARTTIME bigint,
  PROCEDUREENDTIME   bigint,
  ENBID              bigint,
  TARGETENBID        bigint,
  DIR_STATE          int,
  SEQNUM             int,
  ISPUB              int
)
PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
location '/${DB_PATH}/BusinessGtUser';


CREATE DATABASE IF NOT EXISTS ${BaseDB};
use ${BaseDB} ;

drop table if exists tb_xdr_ifc_x2;
  CREATE EXTERNAL TABLE tb_xdr_ifc_x2(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus bigint,
  cellid bigint,
  targetcellid bigint,
  enbid bigint,
  targetenbid bigint,
  mmeues1apid bigint,
  mmegroupid bigint,
  mmecode bigint,
  requestcause bigint,
  failurecause bigint,
  epsbearernumber bigint,
  bearer0id bigint,
  bearer0status bigint,
  bearer1id bigint,
  bearer1status bigint,
  bearer2id bigint,
  bearer2status bigint,
  bearer3id bigint,
  bearer3status bigint,
  bearer4id bigint,
  bearer4status bigint,
  bearer5id bigint,
  bearer5status bigint,
  bearer6id bigint,
  bearer6status bigint,
  bearer7id bigint,
  bearer7status bigint,
  bearer8id bigint,
  bearer8status bigint,
  bearer9id bigint,
  bearer9status bigint,
  bearer10id bigint,
  bearer10status bigint,
  bearer11id bigint,
  bearer11status bigint,
  bearer12id bigint,
  bearer12status bigint,
  bearer13id bigint,
  bearer13status bigint,
  bearer14id bigint,
  bearer14status bigint,
  bearer15id bigint,
  bearer15status bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_X2' ;

drop table if exists tb_xdr_ifc_http;
  CREATE EXTERNAL TABLE tb_xdr_ifc_http(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid bigint,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum bigint,
  tcplinkstatus bigint,
  sessionflag int,
  httpversion string,
  transactiontype string,
  httpstate string,
  httpfirstrede bigint,
  httplastrede bigint,
  acklastconf bigint,
  host string,
  uri string,
  xonlinehost string,
  useragent string,
  httpcontenttype string,
  referuri string,
  cookie string,
  contentlength bigint,
  targetbehavior int,
  wtpinterrupttype int,
  wtpinterruptcause int,
  title string,
  keyword string,
  busconductlogo int,
  buscompletionflag int,
  busrede int,
  browsingtool int,
  portalapp int,
  parentxdrid string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/tb_xdr_ifc_s1u_http_new' ;

DROP TABLE   IF EXISTS LTE_MRO_SOURCE;
create EXTERNAL table   IF NOT EXISTS LTE_MRO_SOURCE
(
       objectID       STRING ,
       VID             BIGINT  ,
       fileFormatVersion STRING ,
       startTime       STRING  ,
       endTime         STRING ,
       period          BIGINT ,
       enbID           BIGINT,
       userLabel      STRING ,
       mrName         STRING ,
       cellID          BIGINT ,
       Earfcn          BIGINT ,
       SubFrameNbr     BIGINT ,
       PRBNbr          BIGINT ,
       MmeUeS1apId     BIGINT ,
       MmeGroupId      BIGINT ,
       MmeCode         BIGINT ,
       meaTime         STRING ,
       EventType      STRING ,
       gridcenterLongitude   STRING,
       gridcenterLatitude    STRING,
       kpi1            BIGINT ,
       kpi2            BIGINT ,
       kpi3            BIGINT ,
       kpi4            BIGINT ,
       kpi5            BIGINT ,
       kpi6            BIGINT ,
       kpi7            BIGINT ,
       kpi8            BIGINT ,
       kpi9            BIGINT ,
       kpi10           BIGINT ,
       kpi11           BIGINT ,
       kpi12           BIGINT ,
       kpi13           BIGINT ,
       kpi14           BIGINT ,
       kpi15           BIGINT ,
       kpi16           BIGINT ,
       kpi17           BIGINT ,
       kpi18           BIGINT ,
       kpi19           BIGINT ,
       kpi20           BIGINT ,
       kpi21           BIGINT ,
       kpi22           BIGINT ,
       kpi23           BIGINT ,
       kpi24           BIGINT ,
       kpi25           BIGINT ,
       kpi26           BIGINT ,
       kpi27           BIGINT ,
       kpi28           BIGINT ,
       kpi29           BIGINT ,
       kpi30           BIGINT ,
       kpi31           BIGINT ,
       kpi32           BIGINT ,
       kpi33           BIGINT ,
       kpi34           BIGINT ,
       kpi35           BIGINT ,
       kpi36           BIGINT ,
       kpi37           BIGINT ,
       kpi38           BIGINT ,
       kpi39           BIGINT ,
       kpi40           BIGINT ,
       kpi41           BIGINT ,
       kpi42           BIGINT ,
       kpi43           BIGINT ,
       kpi44           BIGINT ,
       kpi45           BIGINT ,
       kpi46           BIGINT ,
       kpi47           BIGINT ,
       kpi48           BIGINT ,
       kpi49           BIGINT ,
       kpi50           BIGINT ,
       kpi51           BIGINT ,
       kpi52           BIGINT ,
       kpi53           BIGINT ,
       kpi54           BIGINT ,
       kpi55           BIGINT ,
       kpi56           BIGINT ,
       kpi57           BIGINT ,
       kpi58           BIGINT ,
       kpi59           BIGINT ,
       kpi60           BIGINT ,
       kpi61           BIGINT ,
       kpi62           BIGINT ,
       kpi63           BIGINT ,
       kpi64           BIGINT ,
       kpi65           BIGINT ,
       kpi66           BIGINT ,
       kpi67           BIGINT ,
       kpi68           BIGINT ,
       kpi69           BIGINT ,
       kpi70           BIGINT ,
       kpi71           BIGINT ,
       length          BIGINT ,
       City            STRING ,
       XDRType         BIGINT ,
       Interface       BIGINT ,
       XDRID          STRING ,
       RAT             BIGINT ,
       IMSI           STRING ,
       IMEI           STRING ,
       MSISDN         STRING ,
       MRType          BIGINT ,
       NeighborCellNumber BIGINT ,
       gsmNeighborCellNumber   BIGINT ,
       tdsNeighborCellNumber   BIGINT ,
       v_enb BIGINT,
     mrtime   BIGINT
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/LTE_MRO_SOURCE';


drop table if exists tb_xdr_ifc_s1mme;
CREATE EXTERNAL TABLE tb_xdr_ifc_s1mme(
  length int,
  city string,
  interface int,
  xdrid string,
  rat int,
  imsi string,
  imei string,
  msisdn string,
  proceduretype int,
  procedurestarttime bigint,
  procedureendtime bigint,
  procedurestatus int,
  requestcause int,
  failurecause int,
  keyword1 int,
  keyword2 int,
  keyword3 int,
  keyword4 int,
  mmeues1apid int,
  oldmmegroupid int,
  oldmmecode int,
  oldmtmsi int,
  mmegroupid int,
  mmecode int,
  mtmsi int,
  tmsi int,
  useripv4 string,
  useripv6 string,
  mmeipadd string,
  enbipadd string,
  mmeport int,
  enbport int,
  tac int,
  cellid int,
  othertac int,
  othereci int,
  apn string,
  epsbearernumber int,
  bearer0id int,
  bearer0type int,
  bearer0qci int,
  bearer0status int,
  bearer0requestcause int,
  bearer0failurecause int,
  bearer0enbgtpteid int,
  bearer0sgwgtpteid int,
  bearer1id int,
  bearer1type int,
  bearer1qci int,
  bearer1status int,
  bearer1requestcause int,
  bearer1failurecause int,
  bearer1enbgtpteid int,
  bearer1sgwgtpteid int,
  bearer2id int,
  bearer2type int,
  bearer2qci int,
  bearer2status int,
  bearer2requestcause int,
  bearer2failurecause int,
  bearer2enbgtpteid int,
  bearer2sgwgtpteid int,
  bearer3id int,
  bearer3type int,
  bearer3qci int,
  bearer3status int,
  bearer3requestcause int,
  bearer3failurecause int,
  bearer3enbgtpteid int,
  bearer3sgwgtpteid int,
  bearer4id int,
  bearer4type int,
  bearer4qci int,
  bearer4status int,
  bearer4requestcause int,
  bearer4failurecause int,
  bearer4enbgtpteid int,
  bearer4sgwgtpteid int,
  bearer5id int,
  bearer5type int,
  bearer5qci int,
  bearer5status int,
  bearer5requestcause int,
  bearer5failurecause int,
  bearer5enbgtpteid int,
  bearer5sgwgtpteid int,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_S1MME' ;

drop table if exists tb_xdr_ifc_dns;
CREATE EXTERNAL TABLE tb_xdr_ifc_dns(
  length int,
  city int,
  interface int,
  xdrid string,
  rat int,
  imsi bigint,
  imei bigint,
  msisdn bigint,
  machineipaddtype int,
  sgwipaddr string,
  enbipaddr string,
  sgwport int,
  enbport int,
  enbgtpteid string,
  sgwgtpteid bigint,
  tac bigint,
  ecgi bigint,
  apn string,
  apptypecode bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  protocoltype bigint,
  apptype bigint,
  appsubtype bigint,
  appcontent int,
  appstatus int,
  useripv4 string,
  useripv6 string,
  userport string,
  l4protocal int,
  appserveripipv4 string,
  appserveripipv6 string,
  appserverport string,
  uldata bigint,
  dldata bigint,
  ulippacket bigint,
  dlippacket bigint,
  ultcppacketor bigint,
  dltcppacketor bigint,
  ultcppacketre bigint,
  dltcppacketre bigint,
  tcpestabrede bigint,
  tcpestabdeconf bigint,
  ulipfragpackets bigint,
  dlipfragpackets bigint,
  tcpfirstrede bigint,
  tcpfirstconf bigint,
  winsize bigint,
  msssize bigint,
  tcpattnum int,
  tcplinkstatus int,
  sessionflag int,
  reqdns string,
  resultip string,
  dnsrecode bigint,
  dnsattnum bigint,
  dnsrenum bigint,
  licensedconnum bigint,
  additionalconnum bigint,
  parentxdrid string)
  PARTITIONED BY (
  dt string,
  h string
  )
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/tb_xdr_ifc_dns' ;

--山西现场
drop table if exists tb_xdr_ifc_sv;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport bigint,
  destneip string,
  destneport bigint,
  roamdirection bigint,
  homemcc bigint,
  homemnc bigint,
  mcc bigint,
  mnc bigint,
  targetlac bigint,
  sourcetac bigint,
  sourceeci bigint,
  svflags bigint,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid bigint,
  dlcmmeteid bigint,
  stnsr string,
  targetrncid bigint,
  targetcellid bigint,
  arp bigint,
  requestresult bigint,
  result bigint,
  svcause bigint,
  postfailurecause bigint,
  respdelay bigint,
  svdelay bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_SV';


DROP TABLE  IF EXISTS TB_XDR_IFC_GMMWMGMIMJISC;
CREATE EXTERNAL TABLE  IF NOT EXISTS TB_XDR_IFC_GMMWMGMIMJISC (
      LENGTH                        BIGINT,
      CITY                         STRING,
      INTERFACE                     BIGINT,
      XDRID                        STRING,
      RAT                           BIGINT,
      IMSI                         STRING,
      IMEI                         STRING,
      MSISDN                       STRING,
      PROCEDURETYPE                 BIGINT,
      PROCEDURESTARTTIME           BIGINT,
      PROCEDUREENDTIME             BIGINT,
      SERVICETYPE                   BIGINT,
      PROCEDURESTATUS               BIGINT,
      CALLINGNUMBER                STRING,
      CALLEDNUMBER                 STRING,
      CALLINGPARTYURI              STRING,
      REQUESTURI                   STRING,
      USERIP                       STRING,
      CALLID                       STRING,
      ICID                         STRING,
      SOURCENEIP                   STRING,
      SOURCENEPORT                  BIGINT,
      DESTNEIP                     STRING,
      DESTNEPORT                    BIGINT,
      CALLSIDE                      BIGINT,
      SOURCEACCESSTYPE              BIGINT,
      SOURCEECI                     BIGINT,
      SOURCETAC                     BIGINT,
      SOURCEIMSI                   STRING,
      SOURCEIMEI                   STRING,
      DESTACCESSTYPE                BIGINT,
      DESTECI                       BIGINT,
      DESTTAC                       BIGINT,
      DESTIMSI                     STRING,
      DESTIMEI                     STRING,
      AUTHTYPE                      BIGINT,
      EXPIRESTIMEREQ               BIGINT,
      EXPIRESTIMERSP               BIGINT,
      CALLINGSDPIPADDR             STRING,
      CALLINGAUDIOSDPPORT           BIGINT,
      CALLINGVIDEOSDPPORT           BIGINT,
      CALLEDSDPIPADDR              STRING,
      CALLEDAUDIOSDPPORT            BIGINT,
      CALLEDVIDEOPORT               BIGINT,
      AUDIOCODEC                    BIGINT,
      VIDEOCODEC                    BIGINT,
      REDIRECTINGPARTYADDRESS      STRING,
      ORIGINALPARTYADDRESS         STRING,
      REDIRECTREASON                BIGINT,
      RESPONSECODE                  BIGINT,
      FINISHWARNINGCODE             BIGINT,
      FINISHREASONPROTOCOL          BIGINT,
      FINISHREASONCAUSE             BIGINT,
      FIRFAILTIME                  BIGINT,
      FIRSTFAILNEIP                STRING,
      ALERTINGTIME                 BIGINT,
      ANSWERTIME                   BIGINT,
      RELEASETIME                  BIGINT,
      CALLDURATION                  BIGINT,
      AUTHREQTIME                  BIGINT,
      AUTHRSPTIME                  BIGINT,
      STNSR                        STRING,
      ATCFMGMT                     STRING,
      ATUSTI                       STRING,
      CMSISDN                      STRING,
      SSI                          STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/TB_XDR_IFC_GMMWMGMIMJISC';

DROP TABLE  IF EXISTS tb_xdr_ifc_mw;
CREATE EXTERNAL TABLE  IF NOT EXISTS tb_xdr_ifc_mw (
      LENGTH                        BIGINT,
      CITY                         STRING,
      INTERFACE                     BIGINT,
      XDRID                        STRING,
      RAT                           BIGINT,
      IMSI                         STRING,
      IMEI                         STRING,
      MSISDN                       STRING,
      PROCEDURETYPE                 BIGINT,
      PROCEDURESTARTTIME           BIGINT,
      PROCEDUREENDTIME             BIGINT,
      SERVICETYPE                   BIGINT,
      PROCEDURESTATUS               BIGINT,
      CALLINGNUMBER                STRING,
      CALLEDNUMBER                 STRING,
      CALLINGPARTYURI              STRING,
      REQUESTURI                   STRING,
      USERIP                       STRING,
      CALLID                       STRING,
      ICID                         STRING,
      SOURCENEIP                   STRING,
      SOURCENEPORT                  BIGINT,
      DESTNEIP                     STRING,
      DESTNEPORT                    BIGINT,
      CALLSIDE                      BIGINT,
      SOURCEACCESSTYPE              BIGINT,
      SOURCEECI                     BIGINT,
      SOURCETAC                     BIGINT,
      SOURCEIMSI                   STRING,
      SOURCEIMEI                   STRING,
      DESTACCESSTYPE                BIGINT,
      DESTECI                       BIGINT,
      DESTTAC                       BIGINT,
      DESTIMSI                     STRING,
      DESTIMEI                     STRING,
      AUTHTYPE                      BIGINT,
      EXPIRESTIMEREQ               BIGINT,
      EXPIRESTIMERSP               BIGINT,
      CALLINGSDPIPADDR             STRING,
      CALLINGAUDIOSDPPORT           BIGINT,
      CALLINGVIDEOSDPPORT           BIGINT,
      CALLEDSDPIPADDR              STRING,
      CALLEDAUDIOSDPPORT            BIGINT,
      CALLEDVIDEOPORT               BIGINT,
      AUDIOCODEC                    BIGINT,
      VIDEOCODEC                    BIGINT,
      REDIRECTINGPARTYADDRESS      STRING,
      ORIGINALPARTYADDRESS         STRING,
      REDIRECTREASON                BIGINT,
      RESPONSECODE                  BIGINT,
      FINISHWARNINGCODE             BIGINT,
      FINISHREASONPROTOCOL          BIGINT,
      FINISHREASONCAUSE             BIGINT,
      FIRFAILTIME                  BIGINT,
      FIRSTFAILNEIP                STRING,
      ALERTINGTIME                 BIGINT,
      ANSWERTIME                   BIGINT,
      RELEASETIME                  BIGINT,
      CALLDURATION                  BIGINT,
      AUTHREQTIME                  BIGINT,
      AUTHRSPTIME                  BIGINT,
      STNSR                        STRING,
      ATCFMGMT                     STRING,
      ATUSTI                       STRING,
      CMSISDN                      STRING,
      SSI                          STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/TB_XDR_IFC_GMMWMGMIMJISC';

drop table if exists tb_xdr_ifc_sv;
CREATE EXTERNAL TABLE tb_xdr_ifc_sv(
  parentxdrid string,
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  sourceneip string,
  sourceneport bigint,
  destneip string,
  destneport bigint,
  roamdirection bigint,
  homemcc bigint,
  homemnc bigint,
  mcc bigint,
  mnc bigint,
  targetlac bigint,
  sourcetac bigint,
  sourceeci bigint,
  svflags bigint,
  ulcmscip string,
  dlcmmeip string,
  ulcmscteid bigint,
  dlcmmeteid bigint,
  stnsr string,
  targetrncid bigint,
  targetcellid bigint,
  arp bigint,
  requestresult bigint,
  result bigint,
  svcause bigint,
  postfailurecause bigint,
  respdelay bigint,
  svdelay bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_SV';

 drop table if exists tb_xdr_ifc_gxrx;
CREATE EXTERNAL TABLE tb_xdr_ifc_gxrx(
  length bigint,
  city string,
  interface bigint,
  xdrid string,
  rat bigint,
  imsi string,
  imei string,
  msisdn string,
  proceduretype bigint,
  procedurestarttime bigint,
  procedureendtime bigint,
  icid string,
  originrealm string,
  destinationrealm string,
  originhost string,
  destinationhost string,
  sgsnsgwsigip string,
  afappid string,
  ccrequesttype bigint,
  rxrequesttype bigint,
  mediatype bigint,
  abortcause bigint,
  resultcode bigint,
  experimentalresultcode bigint,
  sessionreleasecause bigint,
  rangetime string)
PARTITIONED BY (
  dt string,
  h string)
ROW FORMAT DELIMITED
  FIELDS TERMINATED BY ','
LOCATION
  'hdfs://dtcluster/${BasePath}/TB_XDR_IFC_GXRX' ;


DROP TABLE IF EXISTS TB_XDR_IFC_UU ;
CREATE EXTERNAL TABLE  IF NOT EXISTS  TB_XDR_IFC_UU (
      PARENTXDRID                  STRING,
      LENGTH                       BIGINT,
      CITY                         STRING,
      INTERFACE                     INT,
      XDRID                         STRING,
      RAT                           BIGINT,
      IMSI                          STRING,
      IMEI                          STRING,
      MSISDN                        STRING,
      PROCEDURETYPE                 INT,
      PROCEDURESTARTTIME            BIGINT, -- STRING,
      PROCEDUREENDTIME              BIGINT, -- STRING,
      KEYWORD1                      INT,
      KEYWORD2                      INT,
      PROCEDURESTATUS               INT,
      PLMNID                        STRING,
      ENBID                         BIGINT,
      CELLID                        BIGINT,
      CRNTI                         BIGINT,
      TARGETENBID                   BIGINT,
      TARGETCELLID                  BIGINT,
      TARGETCRNTI                   BIGINT,
      MMEUES1APID                   BIGINT,
      MMEGROUPID                    BIGINT,
      MMECODE                       BIGINT,
      MTMSI                         BIGINT,
      CSFBINDICATION                BIGINT,
      REDIRECTEDNETWORK             BIGINT,
      EPSBEARERNUMBER               INT,
      BEARER0ID                     BIGINT,
      BEARER0STATUS                 BIGINT,
      BEARER1ID                     BIGINT,
      BEARER1STATUS                 BIGINT,
      BEARER2ID                     BIGINT,
      BEARER2STATUS                 BIGINT,
      BEARER3ID                     BIGINT,
      BEARER3STATUS                 BIGINT,
      BEARER4ID                     BIGINT,
      BEARER4STATUS                 BIGINT,
      BEARER5ID                     BIGINT,
      BEARER5STATUS                 BIGINT,
      BEARER6ID                     BIGINT,
      BEARER6STATUS                 BIGINT,
      BEARER7ID                     BIGINT,
      BEARER7STATUS                 BIGINT,
      BEARER8ID                     BIGINT,
      BEARER8STATUS                 BIGINT,
      BEARER9ID                     BIGINT,
      BEARER9STATUS                 BIGINT,
      BEARER10ID                     STRING,
      BEARER10STATUS                 STRING,
      BEARER11ID                     STRING,
      BEARER11STATUS                 STRING,
      BEARER12ID                     STRING,
      BEARER12STATUS                 STRING,
      BEARER13ID                     STRING,
      BEARER13STATUS                 STRING,
      BEARER14ID                     STRING,
      BEARER14STATUS                 STRING,
      BEARER15ID                     STRING,
      BEARER15STATUS                 STRING,
      RANGETIME                     STRING
)PARTITIONED BY (
dt STRING,
h STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS  TEXTFILE
location '/${BasePath}/TB_XDR_IFC_UU';

EOF
exit 0
